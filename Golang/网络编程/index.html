<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.1.2, mkdocs-material-5.1.7"><title>ç½‘ç»œç¼–ç¨‹ - Notes</title><link rel=stylesheet href=../../assets/stylesheets/main.4c7052ca.min.css><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style></head> <body dir=ltr> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#_1 class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=../.. title=Notes class="md-header-nav__button md-logo" aria-label=Notes> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> Notes </span> <span class="md-header-nav__topic md-ellipsis"> ç½‘ç»œç¼–ç¨‹ </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class="md-tabs__link md-tabs__link--active"> Home </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=Notes class="md-nav__button md-logo" aria-label=Notes> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. title=Home class=md-nav__link> Home </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#web class=md-nav__link> Web æœåŠ¡å™¨ </a> </li> <li class=md-nav__item> <a href=#ip class=md-nav__link> IP ç±»å‹ </a> </li> <li class=md-nav__item> <a href=#tcp-socket class=md-nav__link> TCP Socket </a> </li> <li class=md-nav__item> <a href=#tcp-client class=md-nav__link> TCP client </a> </li> <li class=md-nav__item> <a href=#tcp-server class=md-nav__link> TCP server </a> </li> <li class=md-nav__item> <a href=#tcp class=md-nav__link> æ§åˆ¶TCPè¿æ¥ </a> </li> <li class=md-nav__item> <a href=#udp-socket class=md-nav__link> UDP Socket </a> </li> <li class=md-nav__item> <a href=#websocket class=md-nav__link> WebSocket </a> </li> <li class=md-nav__item> <a href=#rest class=md-nav__link> REST </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=_1>ç½‘ç»œç¼–ç¨‹<a class=headerlink href=#_1 title="Permanent link">&para;</a></h1> <h2 id=web>Web æœåŠ¡å™¨<a class=headerlink href=#web title="Permanent link">&para;</a></h2> <p><a href=http://golang.org/pkg/net/http/ >åŒ… http</a> é€šè¿‡ä»»ä½•å®ç°äº† <code>http.Handler</code> çš„å€¼æ¥å“åº” HTTP è¯·æ±‚ï¼š</p> <div class=highlight><pre><span></span><code><span class=kn>package</span> <span class=nx>http</span>

<span class=kd>type</span> <span class=nx>Handler</span> <span class=kd>interface</span> <span class=p>{</span>
    <span class=nx>ServeHTTP</span><span class=p>(</span><span class=nx>w</span> <span class=nx>ResponseWriter</span><span class=p>,</span> <span class=nx>r</span> <span class=o>*</span><span class=nx>Request</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div> <p>ä¸¾ä¸ªğŸŒ°ï¼Œä»¥ä¸‹ä»£ç ä¸­ï¼Œç±»å‹ <code>Hello</code> å®ç°äº† <code>http.Handler</code>ã€‚</p> <div class=highlight><pre><span></span><code><span class=kn>package</span> <span class=nx>main</span>

<span class=kn>import</span> <span class=p>(</span>
    <span class=s>&quot;fmt&quot;</span>
    <span class=s>&quot;log&quot;</span>
    <span class=s>&quot;net/http&quot;</span>
<span class=p>)</span>

<span class=kd>type</span> <span class=nx>Hello</span> <span class=kd>struct</span><span class=p>{}</span>

<span class=kd>func</span> <span class=p>(</span><span class=nx>h</span> <span class=nx>Hello</span><span class=p>)</span> <span class=nx>ServeHTTP</span><span class=p>(</span>
    <span class=nx>w</span> <span class=nx>http</span><span class=p>.</span><span class=nx>ResponseWriter</span><span class=p>,</span>
    <span class=nx>r</span> <span class=o>*</span><span class=nx>http</span><span class=p>.</span><span class=nx>Request</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>fmt</span><span class=p>.</span><span class=nx>Fprint</span><span class=p>(</span><span class=nx>w</span><span class=p>,</span> <span class=s>&quot;Hello!&quot;</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nx>main</span><span class=p>()</span> <span class=p>{</span>
    <span class=kd>var</span> <span class=nx>h</span> <span class=nx>Hello</span>
    <span class=nx>err</span> <span class=o>:=</span> <span class=nx>http</span><span class=p>.</span><span class=nx>ListenAndServe</span><span class=p>(</span><span class=s>&quot;localhost:4000&quot;</span><span class=p>,</span> <span class=nx>h</span><span class=p>)</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>log</span><span class=p>.</span><span class=nx>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <h2 id=ip>IP ç±»å‹<a class=headerlink href=#ip title="Permanent link">&para;</a></h2> <p>IPç±»å‹çš„å®šä¹‰å¦‚ä¸‹ï¼š</p> <div class=highlight><pre><span></span><code>type IP []byte
</code></pre></div> <p><code>ParseIP(s string) IP</code>å‡½æ•°ä¼šæŠŠä¸€ä¸ªIPv4æˆ–è€…IPv6çš„åœ°å€è½¬åŒ–æˆIPç±»å‹ã€‚</p> <p>ä¸¾ä¸ªğŸŒ°ï¼š</p> <div class=highlight><pre><span></span><code><span class=kn>package</span> <span class=nx>main</span>
<span class=kn>import</span> <span class=p>(</span>
    <span class=s>&quot;net&quot;</span>
    <span class=s>&quot;os&quot;</span>
    <span class=s>&quot;fmt&quot;</span>
<span class=p>)</span>
<span class=kd>func</span> <span class=nx>main</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>2</span> <span class=p>{</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Fprintf</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stderr</span><span class=p>,</span> <span class=s>&quot;Usage: %s ip-addr\n&quot;</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
        <span class=nx>os</span><span class=p>.</span><span class=nx>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>
    <span class=nx>name</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
    <span class=nx>addr</span> <span class=o>:=</span> <span class=nx>net</span><span class=p>.</span><span class=nx>ParseIP</span><span class=p>(</span><span class=nx>name</span><span class=p>)</span>
    <span class=k>if</span> <span class=nx>addr</span> <span class=o>==</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=s>&quot;Invalid address&quot;</span><span class=p>)</span>
    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=s>&quot;The address is &quot;</span><span class=p>,</span> <span class=nx>addr</span><span class=p>.</span><span class=nx>String</span><span class=p>())</span>
    <span class=p>}</span>
    <span class=nx>os</span><span class=p>.</span><span class=nx>Exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div> <p>æ‰§è¡Œä¹‹åï¼Œè¾“å…¥ä¸€ä¸ªIPåœ°å€å°±ä¼šç»™å‡ºç›¸åº”çš„IPæ ¼å¼</p> <h2 id=tcp-socket>TCP Socket<a class=headerlink href=#tcp-socket title="Permanent link">&para;</a></h2> <p><code>TCPConn</code>ç±»å‹ï¼Œæœ‰ä¸¤ä¸ªä¸»è¦çš„å‡½æ•°ï¼š</p> <div class=highlight><pre><span></span><code>func (c *TCPConn) Write(b []byte) (int, error)
func (c *TCPConn) Read(b []byte) (int, error)
</code></pre></div> <p><code>TCPConn</code>å¯ä»¥ç”¨åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯æ¥è¯»å†™æ•°æ®ã€‚</p> <p><code>TCPAddr</code>ç±»å‹ï¼Œè¡¨ç¤ºä¸€ä¸ªTCPçš„åœ°å€ä¿¡æ¯ï¼Œä»–çš„å®šä¹‰å¦‚ä¸‹ï¼š</p> <div class=highlight><pre><span></span><code><span class=kd>type</span> <span class=nx>TCPAddr</span> <span class=kd>struct</span> <span class=p>{</span>
    <span class=nx>IP</span> <span class=nx>IP</span>
    <span class=nx>Port</span> <span class=kt>int</span>
    <span class=nx>Zone</span> <span class=kt>string</span> <span class=c1>// IPv6 scoped addressing zone</span>
<span class=p>}</span>
</code></pre></div> <p>é€šè¿‡<code>ResolveTCPAddr</code>è·å–ä¸€ä¸ª<code>TCPAddr</code>ï¼š</p> <div class=highlight><pre><span></span><code>func ResolveTCPAddr(net, addr string) (*TCPAddr, os.Error)
</code></pre></div> <ul> <li>netå‚æ•°æ˜¯"tcp4"ã€"tcp6"ã€"tcp"ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œåˆ†åˆ«è¡¨ç¤ºTCP(IPv4-only), TCP(IPv6-only)æˆ–è€…TCP(IPv4, IPv6çš„ä»»æ„ä¸€ä¸ª)ã€‚</li> <li>addrè¡¨ç¤ºåŸŸåæˆ–è€…IPåœ°å€åŠå…¶ç«¯å£å·ï¼Œä¾‹å¦‚"<a href=http://www.google.com/ >www.google.com:80</a>" æˆ–è€…"127.0.0.1:22"ã€‚</li> </ul> <h2 id=tcp-client>TCP client<a class=headerlink href=#tcp-client title="Permanent link">&para;</a></h2> <p>Goè¯­è¨€ä¸­é€šè¿‡netåŒ…ä¸­çš„<code>DialTCP</code>å‡½æ•°æ¥å»ºç«‹ä¸€ä¸ªTCPè¿æ¥ï¼Œå¹¶è¿”å›ä¸€ä¸ª<code>TCPConn</code>ç±»å‹çš„å¯¹è±¡ï¼Œå½“è¿æ¥å»ºç«‹æ—¶æœåŠ¡å™¨ç«¯ä¹Ÿåˆ›å»ºä¸€ä¸ªåŒç±»å‹çš„å¯¹è±¡ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯é€šè¿‡å„è‡ªæ‹¥æœ‰çš„<code>TCPConn</code>å¯¹è±¡æ¥è¿›è¡Œæ•°æ®äº¤æ¢ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œå®¢æˆ·ç«¯é€šè¿‡<code>TCPConn</code>å¯¹è±¡å°†è¯·æ±‚ä¿¡æ¯å‘é€åˆ°æœåŠ¡å™¨ç«¯ï¼Œè¯»å–æœåŠ¡å™¨ç«¯å“åº”çš„ä¿¡æ¯ã€‚æœåŠ¡å™¨ç«¯è¯»å–å¹¶è§£ææ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶è¿”å›åº”ç­”ä¿¡æ¯ï¼Œè¿™ä¸ªè¿æ¥åªæœ‰å½“ä»»ä¸€ç«¯å…³é—­äº†è¿æ¥ä¹‹åæ‰å¤±æ•ˆï¼Œä¸ç„¶è¿™è¿æ¥å¯ä»¥ä¸€ç›´åœ¨ä½¿ç”¨ã€‚</p> <p>å»ºç«‹è¿æ¥çš„å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š</p> <div class=highlight><pre><span></span><code><span class=kd>func</span> <span class=nx>DialTCP</span><span class=p>(</span><span class=nx>network</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>laddr</span><span class=p>,</span> <span class=nx>raddr</span> <span class=o>*</span><span class=nx>TCPAddr</span><span class=p>)</span> <span class=p>(</span><span class=o>*</span><span class=nx>TCPConn</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
</code></pre></div> <ul> <li>networkå‚æ•°æ˜¯"tcp4"ã€"tcp6"ã€"tcp"ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œåˆ†åˆ«è¡¨ç¤ºTCP(IPv4-only)ã€TCP(IPv6-only)æˆ–è€…TCP(IPv4,IPv6çš„ä»»æ„ä¸€ä¸ª)</li> <li>laddrè¡¨ç¤ºæœ¬æœºåœ°å€ï¼Œä¸€èˆ¬è®¾ç½®ä¸ºnil</li> <li>raddrè¡¨ç¤ºè¿œç¨‹çš„æœåŠ¡åœ°å€</li> </ul> <p>ä¸¾ä¸ªğŸŒ°ï¼šæ¨¡æ‹Ÿä¸€ä¸ªåŸºäºHTTPåè®®çš„å®¢æˆ·ç«¯è¯·æ±‚å»è¿æ¥ä¸€ä¸ªWebæœåŠ¡ç«¯ã€‚æˆ‘ä»¬è¦å†™ä¸€ä¸ªç®€å•çš„httpè¯·æ±‚å¤´ï¼Œæ ¼å¼ç±»ä¼¼å¦‚ä¸‹ï¼š</p> <div class=highlight><pre><span></span><code><span class=s>&quot;HEAD / HTTP/1.0\r\n\r\n&quot;</span>
</code></pre></div> <p>ä»æœåŠ¡ç«¯æ¥æ”¶åˆ°çš„å“åº”ä¿¡æ¯æ ¼å¼å¯èƒ½å¦‚ä¸‹ï¼š</p> <div class=highlight><pre><span></span><code><span class=err>HTTP/</span><span class=mf>1.0</span> <span class=mi>200</span> <span class=err>OK</span>
<span class=err>ETag:</span> <span class=s2>&quot;-9985996&quot;</span>
<span class=err>Last-Modified:</span> <span class=err>Thu,</span> <span class=mi>25</span> <span class=err>Mar</span> <span class=mi>2010</span> <span class=mi>17</span><span class=err>:</span><span class=mi>51</span><span class=err>:</span><span class=mi>10</span> <span class=err>GMT</span>
<span class=err>Content-Length:</span> <span class=mi>18074</span>
<span class=err>Connection:</span> <span class=err>close</span>
<span class=err>Date:</span> <span class=err>Sat,</span> <span class=mi>28</span> <span class=err>Aug</span> <span class=mi>2010</span> <span class=mi>00</span><span class=err>:</span><span class=mi>43</span><span class=err>:</span><span class=mi>48</span> <span class=err>GMT</span>
<span class=err>Server:</span> <span class=err>lighttpd/</span><span class=mf>1.4</span><span class=err>.</span><span class=mi>23</span>
</code></pre></div> <p>æˆ‘ä»¬çš„å®¢æˆ·ç«¯ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p> <div class=highlight><pre><span></span><code><span class=kn>package</span> <span class=nx>main</span>

<span class=kn>import</span> <span class=p>(</span>
    <span class=s>&quot;fmt&quot;</span>
    <span class=s>&quot;io/ioutil&quot;</span>
    <span class=s>&quot;net&quot;</span>
    <span class=s>&quot;os&quot;</span>
<span class=p>)</span>

<span class=kd>func</span> <span class=nx>main</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>2</span> <span class=p>{</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Fprintf</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stderr</span><span class=p>,</span> <span class=s>&quot;Usage: %s host:port &quot;</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
        <span class=nx>os</span><span class=p>.</span><span class=nx>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>
    <span class=nx>service</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
    <span class=nx>tcpAddr</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>net</span><span class=p>.</span><span class=nx>ResolveTCPAddr</span><span class=p>(</span><span class=s>&quot;tcp4&quot;</span><span class=p>,</span> <span class=nx>service</span><span class=p>)</span>
    <span class=nx>checkError</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
    <span class=nx>conn</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>net</span><span class=p>.</span><span class=nx>DialTCP</span><span class=p>(</span><span class=s>&quot;tcp&quot;</span><span class=p>,</span> <span class=kc>nil</span><span class=p>,</span> <span class=nx>tcpAddr</span><span class=p>)</span>
    <span class=nx>checkError</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
    <span class=nx>_</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>conn</span><span class=p>.</span><span class=nx>Write</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=s>&quot;HEAD / HTTP/1.0\r\n\r\n&quot;</span><span class=p>))</span>
    <span class=nx>checkError</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
    <span class=c1>// result, err := ioutil.ReadAll(conn)</span>
    <span class=nx>result</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=mi>256</span><span class=p>)</span>
    <span class=nx>_</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>conn</span><span class=p>.</span><span class=nx>Read</span><span class=p>(</span><span class=nx>result</span><span class=p>)</span>
    <span class=nx>checkError</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
    <span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>result</span><span class=p>))</span>
    <span class=nx>os</span><span class=p>.</span><span class=nx>Exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<span class=p>}</span>
<span class=kd>func</span> <span class=nx>checkError</span><span class=p>(</span><span class=nx>err</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Fprintf</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stderr</span><span class=p>,</span> <span class=s>&quot;Fatal error: %s&quot;</span><span class=p>,</span> <span class=nx>err</span><span class=p>.</span><span class=nx>Error</span><span class=p>())</span>
        <span class=nx>os</span><span class=p>.</span><span class=nx>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>é€šè¿‡ä¸Šé¢çš„ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼šé¦–å…ˆç¨‹åºå°†ç”¨æˆ·çš„è¾“å…¥ä½œä¸ºå‚æ•°<code>service</code>ä¼ å…¥<code>net.ResolveTCPAddr</code>è·å–ä¸€ä¸ªtcpAddr,ç„¶åæŠŠtcpAddrä¼ å…¥DialTCPååˆ›å»ºäº†ä¸€ä¸ªTCPè¿æ¥<code>conn</code>ï¼Œé€šè¿‡<code>conn</code>æ¥å‘é€è¯·æ±‚ä¿¡æ¯ï¼Œæœ€åé€šè¿‡<code>ioutil.ReadAll</code>ä»<code>conn</code>ä¸­è¯»å–å…¨éƒ¨çš„æ–‡æœ¬ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡ç«¯å“åº”åé¦ˆçš„ä¿¡æ¯ã€‚</p> <h2 id=tcp-server>TCP server<a class=headerlink href=#tcp-server title="Permanent link">&para;</a></h2> <p>åœ¨æœåŠ¡å™¨ç«¯æˆ‘ä»¬éœ€è¦ç»‘å®šæœåŠ¡åˆ°æŒ‡å®šçš„éæ¿€æ´»ç«¯å£ï¼Œå¹¶ç›‘å¬æ­¤ç«¯å£ï¼Œå½“æœ‰å®¢æˆ·ç«¯è¯·æ±‚åˆ°è¾¾çš„æ—¶å€™å¯ä»¥æ¥æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯è¿æ¥çš„è¯·æ±‚ã€‚</p> <p>netåŒ…ä¸­æœ‰ç›¸åº”åŠŸèƒ½çš„å‡½æ•°ï¼Œå‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š</p> <div class=highlight><pre><span></span><code>func ListenTCP(network string, laddr *TCPAddr) (*TCPListener, error)
func (l *TCPListener) Accept() (Conn, error)
</code></pre></div> <p>å‚æ•°è¯´æ˜åŒDialTCPçš„å‚æ•°ä¸€æ ·ã€‚</p> <p>ä¸¾ä¸ªğŸŒ°ï¼š</p> <p>æˆ‘ä»¬å®ç°ä¸€ä¸ªç®€å•çš„æ—¶é—´åŒæ­¥æœåŠ¡ï¼Œç›‘å¬7777ç«¯å£ï¼Œå½“æœ‰æ–°çš„å®¢æˆ·ç«¯è¯·æ±‚åˆ°è¾¾å¹¶åŒæ„æ¥å—<code>Accept</code>è¯¥è¯·æ±‚çš„æ—¶å€™ä»–ä¼šåé¦ˆå½“å‰çš„æ—¶é—´ä¿¡æ¯ã€‚åœ¨ä»£ç ä¸­<code>for</code>å¾ªç¯é‡Œï¼Œå½“æœ‰é”™è¯¯å‘ç”Ÿæ—¶ï¼Œç›´æ¥continueè€Œä¸æ˜¯é€€å‡ºï¼Œæ˜¯å› ä¸ºåœ¨æœåŠ¡å™¨ç«¯è·‘ä»£ç çš„æ—¶å€™ï¼Œå½“æœ‰é”™è¯¯å‘ç”Ÿçš„æƒ…å†µä¸‹æœ€å¥½æ˜¯ç”±æœåŠ¡ç«¯è®°å½•é”™è¯¯ï¼Œç„¶åå½“å‰è¿æ¥çš„å®¢æˆ·ç«¯ç›´æ¥æŠ¥é”™è€Œé€€å‡ºï¼Œä»è€Œä¸ä¼šå½±å“åˆ°å½“å‰æœåŠ¡ç«¯è¿è¡Œçš„æ•´ä¸ªæœåŠ¡ã€‚</p> <div class=highlight><pre><span></span><code><span class=kn>package</span> <span class=nx>main</span>

<span class=kn>import</span> <span class=p>(</span>
    <span class=s>&quot;fmt&quot;</span>
    <span class=s>&quot;net&quot;</span>
    <span class=s>&quot;os&quot;</span>
    <span class=s>&quot;time&quot;</span>
    <span class=s>&quot;strconv&quot;</span>
    <span class=s>&quot;strings&quot;</span>
<span class=p>)</span>

<span class=kd>func</span> <span class=nx>main</span><span class=p>()</span> <span class=p>{</span>
    <span class=nx>service</span> <span class=o>:=</span> <span class=s>&quot;:1200&quot;</span>
    <span class=nx>tcpAddr</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>net</span><span class=p>.</span><span class=nx>ResolveTCPAddr</span><span class=p>(</span><span class=s>&quot;tcp4&quot;</span><span class=p>,</span> <span class=nx>service</span><span class=p>)</span>
    <span class=nx>checkError</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
    <span class=nx>listener</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>net</span><span class=p>.</span><span class=nx>ListenTCP</span><span class=p>(</span><span class=s>&quot;tcp&quot;</span><span class=p>,</span> <span class=nx>tcpAddr</span><span class=p>)</span>
    <span class=nx>checkError</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
    <span class=k>for</span> <span class=p>{</span>
        <span class=nx>conn</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>listener</span><span class=p>.</span><span class=nx>Accept</span><span class=p>()</span>
        <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
            <span class=k>continue</span>
        <span class=p>}</span>
        <span class=k>go</span> <span class=nx>handleClient</span><span class=p>(</span><span class=nx>conn</span><span class=p>)</span> <span class=c1>// å®ç°å¹¶å‘</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=c1>// æŠŠä¸šåŠ¡å¤„ç†åˆ†ç¦»åˆ°å‡½æ•° handleClient</span>
<span class=kd>func</span> <span class=nx>handleClient</span><span class=p>(</span><span class=nx>conn</span> <span class=nx>net</span><span class=p>.</span><span class=nx>Conn</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>conn</span><span class=p>.</span><span class=nx>SetReadDeadline</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nx>Now</span><span class=p>().</span><span class=nx>Add</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Minute</span><span class=p>))</span> <span class=c1>// set 2 minutes timeout</span>
    <span class=nx>request</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=mi>128</span><span class=p>)</span> <span class=c1>// set maxium request length to 128B to prevent flood attack</span>
    <span class=k>defer</span> <span class=nx>conn</span><span class=p>.</span><span class=nx>Close</span><span class=p>()</span>  <span class=c1>// close connection before exit</span>
    <span class=k>for</span> <span class=p>{</span>
        <span class=nx>read_len</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>conn</span><span class=p>.</span><span class=nx>Read</span><span class=p>(</span><span class=nx>request</span><span class=p>)</span>

        <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
            <span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
            <span class=k>break</span>
        <span class=p>}</span>

            <span class=k>if</span> <span class=nx>read_len</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
                <span class=k>break</span> <span class=c1>// connection already closed by client</span>
            <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>strings</span><span class=p>.</span><span class=nx>TrimSpace</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>request</span><span class=p>[:</span><span class=nx>read_len</span><span class=p>]))</span> <span class=o>==</span> <span class=s>&quot;timestamp&quot;</span> <span class=p>{</span>
                <span class=nx>daytime</span> <span class=o>:=</span> <span class=nx>strconv</span><span class=p>.</span><span class=nx>FormatInt</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nx>Now</span><span class=p>().</span><span class=nx>Unix</span><span class=p>(),</span> <span class=mi>10</span><span class=p>)</span>
                <span class=nx>conn</span><span class=p>.</span><span class=nx>Write</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>daytime</span><span class=p>))</span>
            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                <span class=nx>daytime</span> <span class=o>:=</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Now</span><span class=p>().</span><span class=nx>String</span><span class=p>()</span>
                <span class=nx>conn</span><span class=p>.</span><span class=nx>Write</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>daytime</span><span class=p>))</span>
            <span class=p>}</span>

            <span class=nx>request</span> <span class=p>=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=mi>128</span><span class=p>)</span> <span class=c1>// clear last read content</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nx>checkError</span><span class=p>(</span><span class=nx>err</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Fprintf</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stderr</span><span class=p>,</span> <span class=s>&quot;Fatal error: %s&quot;</span><span class=p>,</span> <span class=nx>err</span><span class=p>.</span><span class=nx>Error</span><span class=p>())</span>
        <span class=nx>os</span><span class=p>.</span><span class=nx>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>conn.Read()</code>ä¸æ–­è¯»å–å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚ã€‚ç”±äºæˆ‘ä»¬éœ€è¦ä¿æŒä¸å®¢æˆ·ç«¯çš„é•¿è¿æ¥ï¼Œæ‰€ä»¥ä¸èƒ½åœ¨è¯»å–å®Œä¸€æ¬¡è¯·æ±‚åå°±å…³é—­è¿æ¥ã€‚ç”±äº<code>conn.SetReadDeadline()</code>è®¾ç½®äº†è¶…æ—¶ï¼Œå½“ä¸€å®šæ—¶é—´å†…å®¢æˆ·ç«¯æ— è¯·æ±‚å‘é€ï¼Œ<code>conn</code>ä¾¿ä¼šè‡ªåŠ¨å…³é—­ï¼Œä¸‹é¢çš„forå¾ªç¯å³ä¼šå› ä¸ºè¿æ¥å·²å…³é—­è€Œè·³å‡ºã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>request</code>åœ¨åˆ›å»ºæ—¶éœ€è¦æŒ‡å®šä¸€ä¸ªæœ€å¤§é•¿åº¦ä»¥é˜²æ­¢flood attackï¼›æ¯æ¬¡è¯»å–åˆ°è¯·æ±‚å¤„ç†å®Œæ¯•åï¼Œéœ€è¦æ¸…ç†requestï¼Œå› ä¸º<code>conn.Read()</code>ä¼šå°†æ–°è¯»å–åˆ°çš„å†…å®¹appendåˆ°åŸå†…å®¹ä¹‹åã€‚</p> <h2 id=tcp>æ§åˆ¶TCPè¿æ¥<a class=headerlink href=#tcp title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code><span class=kd>func</span> <span class=nx>DialTimeout</span><span class=p>(</span><span class=nx>net</span><span class=p>,</span> <span class=nx>addr</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>timeout</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Duration</span><span class=p>)</span> <span class=p>(</span><span class=nx>Conn</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>  <span class=c1>// è®¾ç½®å»ºç«‹è¿æ¥çš„è¶…æ—¶æ—¶é—´</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=kd>func</span> <span class=p>(</span><span class=nx>c</span> <span class=o>*</span><span class=nx>TCPConn</span><span class=p>)</span> <span class=nx>SetReadDeadline</span><span class=p>(</span><span class=nx>t</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span><span class=p>)</span> <span class=kt>error</span>  <span class=c1>// è®¾ç½®è¯»å–ä¸€ä¸ªè¿æ¥çš„è¶…æ—¶æ—¶é—´</span>
<span class=kd>func</span> <span class=p>(</span><span class=nx>c</span> <span class=o>*</span><span class=nx>TCPConn</span><span class=p>)</span> <span class=nx>SetWriteDeadline</span><span class=p>(</span><span class=nx>t</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span><span class=p>)</span> <span class=kt>error</span>  <span class=c1>// è®¾ç½®å†™å…¥ä¸€ä¸ªè¿æ¥çš„è¶…æ—¶æ—¶é—´</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=kd>func</span> <span class=p>(</span><span class=nx>c</span> <span class=o>*</span><span class=nx>TCPConn</span><span class=p>)</span> <span class=nx>SetKeepAlive</span><span class=p>(</span><span class=nx>keepalive</span> <span class=kt>bool</span><span class=p>)</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Error</span>  <span class=c1>// è®¾ç½®keepAliveå±æ€§</span>
</code></pre></div> <h2 id=udp-socket>UDP Socket<a class=headerlink href=#udp-socket title="Permanent link">&para;</a></h2> <p>Goè¯­è¨€åŒ…ä¸­å¤„ç†UDP Socketå’ŒTCP Socketä¸åŒçš„åœ°æ–¹å°±æ˜¯åœ¨æœåŠ¡å™¨ç«¯å¤„ç†å¤šä¸ªå®¢æˆ·ç«¯è¯·æ±‚æ•°æ®åŒ…çš„æ–¹å¼ä¸åŒ,UDPç¼ºå°‘äº†å¯¹å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚çš„Acceptå‡½æ•°ã€‚</p> <div class=highlight><pre><span></span><code><span class=kd>func</span> <span class=nx>ResolveUDPAddr</span><span class=p>(</span><span class=nx>net</span><span class=p>,</span> <span class=nx>addr</span> <span class=kt>string</span><span class=p>)</span> <span class=p>(</span><span class=o>*</span><span class=nx>UDPAddr</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Error</span><span class=p>)</span>
<span class=kd>func</span> <span class=nx>DialUDP</span><span class=p>(</span><span class=nx>net</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>laddr</span><span class=p>,</span> <span class=nx>raddr</span> <span class=o>*</span><span class=nx>UDPAddr</span><span class=p>)</span> <span class=p>(</span><span class=nx>c</span> <span class=o>*</span><span class=nx>UDPConn</span><span class=p>,</span> <span class=nx>err</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Error</span><span class=p>)</span>
<span class=kd>func</span> <span class=nx>ListenUDP</span><span class=p>(</span><span class=nx>net</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>laddr</span> <span class=o>*</span><span class=nx>UDPAddr</span><span class=p>)</span> <span class=p>(</span><span class=nx>c</span> <span class=o>*</span><span class=nx>UDPConn</span><span class=p>,</span> <span class=nx>err</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Error</span><span class=p>)</span>
<span class=kd>func</span> <span class=p>(</span><span class=nx>c</span> <span class=o>*</span><span class=nx>UDPConn</span><span class=p>)</span> <span class=nx>ReadFromUDP</span><span class=p>(</span><span class=nx>b</span> <span class=p>[]</span><span class=kt>byte</span><span class=p>)</span> <span class=p>(</span><span class=nx>n</span> <span class=kt>int</span><span class=p>,</span> <span class=nx>addr</span> <span class=o>*</span><span class=nx>UDPAddr</span><span class=p>,</span> <span class=nx>err</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Error</span><span class=p>)</span>
<span class=kd>func</span> <span class=p>(</span><span class=nx>c</span> <span class=o>*</span><span class=nx>UDPConn</span><span class=p>)</span> <span class=nx>WriteToUDP</span><span class=p>(</span><span class=nx>b</span> <span class=p>[]</span><span class=kt>byte</span><span class=p>,</span> <span class=nx>addr</span> <span class=o>*</span><span class=nx>UDPAddr</span><span class=p>)</span> <span class=p>(</span><span class=nx>n</span> <span class=kt>int</span><span class=p>,</span> <span class=nx>err</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Error</span><span class=p>)</span>
</code></pre></div> <p>ä¸¾ä¸ªğŸŒ°</p> <p>UDPçš„å®¢æˆ·ç«¯ï¼šï¼ˆTCPæ¢æˆäº†UDPè€Œå·²ï¼‰</p> <div class=highlight><pre><span></span><code><span class=kn>package</span> <span class=nx>main</span>

<span class=kn>import</span> <span class=p>(</span>
    <span class=s>&quot;fmt&quot;</span>
    <span class=s>&quot;net&quot;</span>
    <span class=s>&quot;os&quot;</span>
<span class=p>)</span>

<span class=kd>func</span> <span class=nx>main</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>2</span> <span class=p>{</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Fprintf</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stderr</span><span class=p>,</span> <span class=s>&quot;Usage: %s host:port&quot;</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
        <span class=nx>os</span><span class=p>.</span><span class=nx>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>
    <span class=nx>service</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
    <span class=nx>udpAddr</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>net</span><span class=p>.</span><span class=nx>ResolveUDPAddr</span><span class=p>(</span><span class=s>&quot;udp4&quot;</span><span class=p>,</span> <span class=nx>service</span><span class=p>)</span>
    <span class=nx>checkError</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
    <span class=nx>conn</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>net</span><span class=p>.</span><span class=nx>DialUDP</span><span class=p>(</span><span class=s>&quot;udp&quot;</span><span class=p>,</span> <span class=kc>nil</span><span class=p>,</span> <span class=nx>udpAddr</span><span class=p>)</span>
    <span class=nx>checkError</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
    <span class=nx>_</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>conn</span><span class=p>.</span><span class=nx>Write</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=s>&quot;anything&quot;</span><span class=p>))</span>
    <span class=nx>checkError</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
    <span class=kd>var</span> <span class=nx>buf</span> <span class=p>[</span><span class=mi>512</span><span class=p>]</span><span class=kt>byte</span>
    <span class=nx>n</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>conn</span><span class=p>.</span><span class=nx>Read</span><span class=p>(</span><span class=nx>buf</span><span class=p>[</span><span class=mi>0</span><span class=p>:])</span>
    <span class=nx>checkError</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
    <span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>buf</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=nx>n</span><span class=p>]))</span>
    <span class=nx>os</span><span class=p>.</span><span class=nx>Exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<span class=p>}</span>
<span class=kd>func</span> <span class=nx>checkError</span><span class=p>(</span><span class=nx>err</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Fprintf</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stderr</span><span class=p>,</span> <span class=s>&quot;Fatal error %s&quot;</span><span class=p>,</span> <span class=nx>err</span><span class=p>.</span><span class=nx>Error</span><span class=p>())</span>
        <span class=nx>os</span><span class=p>.</span><span class=nx>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>ç›¸åº”çš„UDPæœåŠ¡å™¨ç«¯ï¼š</p> <div class=highlight><pre><span></span><code><span class=kn>package</span> <span class=nx>main</span>

<span class=kn>import</span> <span class=p>(</span>
    <span class=s>&quot;fmt&quot;</span>
    <span class=s>&quot;net&quot;</span>
    <span class=s>&quot;os&quot;</span>
    <span class=s>&quot;time&quot;</span>
<span class=p>)</span>

<span class=kd>func</span> <span class=nx>main</span><span class=p>()</span> <span class=p>{</span>
    <span class=nx>service</span> <span class=o>:=</span> <span class=s>&quot;:1200&quot;</span>
    <span class=nx>udpAddr</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>net</span><span class=p>.</span><span class=nx>ResolveUDPAddr</span><span class=p>(</span><span class=s>&quot;udp4&quot;</span><span class=p>,</span> <span class=nx>service</span><span class=p>)</span>
    <span class=nx>checkError</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
    <span class=nx>conn</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>net</span><span class=p>.</span><span class=nx>ListenUDP</span><span class=p>(</span><span class=s>&quot;udp&quot;</span><span class=p>,</span> <span class=nx>udpAddr</span><span class=p>)</span>
    <span class=nx>checkError</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
    <span class=k>for</span> <span class=p>{</span>
        <span class=nx>handleClient</span><span class=p>(</span><span class=nx>conn</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
<span class=kd>func</span> <span class=nx>handleClient</span><span class=p>(</span><span class=nx>conn</span> <span class=o>*</span><span class=nx>net</span><span class=p>.</span><span class=nx>UDPConn</span><span class=p>)</span> <span class=p>{</span>
    <span class=kd>var</span> <span class=nx>buf</span> <span class=p>[</span><span class=mi>512</span><span class=p>]</span><span class=kt>byte</span>
    <span class=nx>_</span><span class=p>,</span> <span class=nx>addr</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>conn</span><span class=p>.</span><span class=nx>ReadFromUDP</span><span class=p>(</span><span class=nx>buf</span><span class=p>[</span><span class=mi>0</span><span class=p>:])</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=k>return</span>
    <span class=p>}</span>
    <span class=nx>daytime</span> <span class=o>:=</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Now</span><span class=p>().</span><span class=nx>String</span><span class=p>()</span>
    <span class=nx>conn</span><span class=p>.</span><span class=nx>WriteToUDP</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>daytime</span><span class=p>),</span> <span class=nx>addr</span><span class=p>)</span>
<span class=p>}</span>
<span class=kd>func</span> <span class=nx>checkError</span><span class=p>(</span><span class=nx>err</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>fmt</span><span class=p>.</span><span class=nx>Fprintf</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stderr</span><span class=p>,</span> <span class=s>&quot;Fatal error %s&quot;</span><span class=p>,</span> <span class=nx>err</span><span class=p>.</span><span class=nx>Error</span><span class=p>())</span>
        <span class=nx>os</span><span class=p>.</span><span class=nx>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <h2 id=websocket>WebSocket<a class=headerlink href=#websocket title="Permanent link">&para;</a></h2> <p>WebSocket åˆ†ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯</p> <p>WebSocket é‡‡ç”¨äº†ä¸€äº›ç‰¹æ®Šçš„æŠ¥å¤´ï¼Œä½¿å¾—æµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦åšä¸€ä¸ªæ¡æ‰‹çš„åŠ¨ä½œï¼Œå°±å¯ä»¥åœ¨æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹ä¸€æ¡è¿æ¥é€šé“ã€‚ä¸”æ­¤è¿æ¥ä¼šä¿æŒåœ¨æ´»åŠ¨çŠ¶æ€ï¼Œä½ å¯ä»¥ä½¿ç”¨JavaScriptæ¥å‘è¿æ¥å†™å…¥æˆ–ä»ä¸­æ¥æ”¶æ•°æ®ï¼Œå°±åƒåœ¨ä½¿ç”¨ä¸€ä¸ªå¸¸è§„çš„TCP Socketä¸€æ ·ã€‚å®ƒè§£å†³äº†Webå®æ—¶åŒ–çš„é—®é¢˜ï¼Œç›¸æ¯”ä¼ ç»ŸHTTPæœ‰å¦‚ä¸‹å¥½å¤„ï¼š</p> <ul> <li>ä¸€ä¸ªWebå®¢æˆ·ç«¯åªå»ºç«‹ä¸€ä¸ªTCPè¿æ¥</li> <li>WebsocketæœåŠ¡ç«¯å¯ä»¥æ¨é€(push)æ•°æ®åˆ°webå®¢æˆ·ç«¯.</li> <li>æœ‰æ›´åŠ è½»é‡çº§çš„å¤´ï¼Œå‡å°‘æ•°æ®ä¼ é€é‡</li> </ul> <p>WebSocket URLçš„èµ·å§‹è¾“å…¥æ˜¯ws://æˆ–æ˜¯wss://ï¼ˆåœ¨SSLä¸Šï¼‰ã€‚</p> <p>Goè¯­è¨€æ ‡å‡†åŒ…é‡Œé¢æ²¡æœ‰æä¾›å¯¹WebSocketçš„æ”¯æŒï¼Œä½†æ˜¯åœ¨ç”±å®˜æ–¹ç»´æŠ¤çš„go.netå­åŒ…ä¸­æœ‰å¯¹è¿™ä¸ªçš„æ”¯æŒï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤è·å–è¯¥åŒ…ï¼š</p> <div class=highlight><pre><span></span><code><span class=k>go</span> <span class=nx>get</span> <span class=nx>golang</span><span class=p>.</span><span class=nx>org</span><span class=o>/</span><span class=nx>x</span><span class=o>/</span><span class=nx>net</span><span class=o>/</span><span class=nx>websocket</span>
</code></pre></div> <p>ä¸¾ä¸ªğŸŒ°: </p> <p>éœ€æ±‚ï¼šç”¨æˆ·è¾“å…¥ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯é€šè¿‡WebSocketå°†ä¿¡æ¯å‘é€ç»™æœåŠ¡å™¨ç«¯ï¼ŒæœåŠ¡å™¨ç«¯æ”¶åˆ°ä¿¡æ¯ä¹‹åä¸»åŠ¨Pushä¿¡æ¯åˆ°å®¢æˆ·ç«¯ï¼Œç„¶åå®¢æˆ·ç«¯å°†è¾“å‡ºå…¶æ”¶åˆ°çš„ä¿¡æ¯ã€‚</p> <p>å®¢æˆ·ç«¯çš„ä»£ç å¦‚ä¸‹ï¼š</p> <div class=highlight><pre><span></span><code>&lt;html&gt;
&lt;head&gt;&lt;/head&gt;
&lt;body&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
        var sock = null;
        var wsuri = &quot;ws://127.0.0.1:1234&quot;;

        window.onload = function() {

            console.log(&quot;onload&quot;);

            sock = new WebSocket(wsuri);

            sock.onopen = function() {
                console.log(&quot;connected to &quot; + wsuri);
            }

            sock.onclose = function(e) {
                console.log(&quot;connection closed (&quot; + e.code + &quot;)&quot;);
            }

            sock.onmessage = function(e) {
                console.log(&quot;message received: &quot; + e.data);
            }
        };

        function send() {
            var msg = document.getElementById(&#39;message&#39;).value;
            sock.send(msg);
        };
    &lt;/script&gt;
    &lt;h1&gt;WebSocket Echo Test&lt;/h1&gt;
    &lt;form&gt;
        &lt;p&gt;
            Message: &lt;input id=&quot;message&quot; type=&quot;text&quot; value=&quot;Hello, world!&quot;&gt;
        &lt;/p&gt;
    &lt;/form&gt;
    &lt;button onclick=&quot;send();&quot;&gt;Send Message&lt;/button&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre></div> <p>å¯ä»¥çœ‹åˆ°å®¢æˆ·ç«¯JSï¼Œå¾ˆå®¹æ˜“çš„å°±é€šè¿‡WebSocketå‡½æ•°å»ºç«‹äº†ä¸€ä¸ªä¸æœåŠ¡å™¨çš„è¿æ¥sockï¼Œå½“æ¡æ‰‹æˆåŠŸåï¼Œä¼šè§¦å‘WebSocketå¯¹è±¡çš„onopenäº‹ä»¶ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯è¿æ¥å·²ç»æˆåŠŸå»ºç«‹ã€‚å®¢æˆ·ç«¯ä¸€å…±ç»‘å®šäº†å››ä¸ªäº‹ä»¶ã€‚</p> <ul> <li>1ï¼‰onopen å»ºç«‹è¿æ¥åè§¦å‘</li> <li>2ï¼‰onmessage æ”¶åˆ°æ¶ˆæ¯åè§¦å‘</li> <li>3ï¼‰onerror å‘ç”Ÿé”™è¯¯æ—¶è§¦å‘</li> <li>4ï¼‰onclose å…³é—­è¿æ¥æ—¶è§¦å‘</li> </ul> <p>æˆ‘ä»¬æœåŠ¡å™¨ç«¯çš„å®ç°å¦‚ä¸‹ï¼š</p> <div class=highlight><pre><span></span><code>package main

import (
    &quot;golang.org/x/net/websocket&quot;
    &quot;fmt&quot;
    &quot;log&quot;
    &quot;net/http&quot;
)

func Echo(ws *websocket.Conn) {
    var err error

    for {
        var reply string

        if err = websocket.Message.Receive(ws, &amp;reply); err != nil {
            fmt.Println(&quot;Can&#39;t receive&quot;)
            break
        }

        fmt.Println(&quot;Received back from client: &quot; + reply)

        msg := &quot;Received:  &quot; + reply
        fmt.Println(&quot;Sending to client: &quot; + msg)

        if err = websocket.Message.Send(ws, msg); err != nil {
            fmt.Println(&quot;Can&#39;t send&quot;)
            break
        }
    }
}

func main() {
    http.Handle(&quot;/&quot;, websocket.Handler(Echo))

    if err := http.ListenAndServe(&quot;:1234&quot;, nil); err != nil {
        log.Fatal(&quot;ListenAndServe:&quot;, err)
    }
}
</code></pre></div> <p>å½“å®¢æˆ·ç«¯å°†ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯Sendä¹‹åï¼ŒæœåŠ¡å™¨ç«¯é€šè¿‡Receiveæ¥æ”¶åˆ°äº†ç›¸åº”ä¿¡æ¯ï¼Œç„¶åé€šè¿‡Sendå‘é€äº†åº”ç­”ä¿¡æ¯ã€‚</p> <h2 id=rest>REST<a class=headerlink href=#rest title="Permanent link">&para;</a></h2> <ul> <li>HTMLæ ‡å‡†åªèƒ½é€šè¿‡é“¾æ¥å’Œè¡¨å•æ”¯æŒ<code>GET</code>å’Œ<code>POST</code>ã€‚åœ¨æ²¡æœ‰Ajaxæ”¯æŒçš„ç½‘é¡µæµè§ˆå™¨ä¸­ä¸èƒ½å‘å‡º<code>PUT</code>æˆ–<code>DELETE</code>å‘½ä»¤</li> <li>æœ‰äº›é˜²ç«å¢™ä¼šæŒ¡ä½HTTP <code>PUT</code>å’Œ<code>DELETE</code>è¯·æ±‚ï¼Œè¦ç»•è¿‡è¿™ä¸ªé™åˆ¶ï¼Œå®¢æˆ·ç«¯éœ€è¦æŠŠå®é™…çš„<code>PUT</code>å’Œ<code>DELETE</code>è¯·æ±‚é€šè¿‡ POST è¯·æ±‚ç©¿é€è¿‡æ¥ã€‚RESTful æœåŠ¡åˆ™è¦è´Ÿè´£åœ¨æ”¶åˆ°çš„ POST è¯·æ±‚ä¸­æ‰¾åˆ°åŸå§‹çš„ HTTP æ–¹æ³•å¹¶è¿˜åŸã€‚å¯ä»¥é€šè¿‡<code>POST</code>é‡Œé¢å¢åŠ éšè—å­—æ®µ<code>_method</code>è¿™ç§æ–¹å¼å¯ä»¥æ¥æ¨¡æ‹Ÿ<code>PUT</code>ã€<code>DELETE</code>ç­‰æ–¹å¼ï¼Œä½†æ˜¯æœåŠ¡å™¨ç«¯éœ€è¦åšè½¬æ¢ã€‚</li> </ul> <p>ä¸¾ä¸ªğŸŒ°: </p> <p>éœ€æ±‚ï¼šæˆ‘ä»¬è®¿é—®çš„èµ„æºæ˜¯ç”¨æˆ·ï¼Œæˆ‘ä»¬é€šè¿‡ä¸åŒçš„methodæ¥è®¿é—®ä¸åŒçš„å‡½æ•°ã€‚</p> <p>ç¬¬ä¸‰æ–¹åº“<code>github.com/julienschmidt/httprouter</code>ï¼Œè¿™ä¸ªåº“å®ç°äº†è‡ªå®šä¹‰è·¯ç”±å’Œæ–¹ä¾¿çš„è·¯ç”±è§„åˆ™æ˜ å°„ï¼Œé€šè¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„å®ç°RESTçš„æ¶æ„ã€‚</p> <div class=highlight><pre><span></span><code><span class=kn>package</span> <span class=nx>main</span>

<span class=kn>import</span> <span class=p>(</span>
    <span class=s>&quot;fmt&quot;</span>
    <span class=s>&quot;log&quot;</span>
    <span class=s>&quot;net/http&quot;</span>

    <span class=s>&quot;github.com/julienschmidt/httprouter&quot;</span>
<span class=p>)</span>

<span class=kd>func</span> <span class=nx>Index</span><span class=p>(</span><span class=nx>w</span> <span class=nx>http</span><span class=p>.</span><span class=nx>ResponseWriter</span><span class=p>,</span> <span class=nx>r</span> <span class=o>*</span><span class=nx>http</span><span class=p>.</span><span class=nx>Request</span><span class=p>,</span> <span class=nx>_</span> <span class=nx>httprouter</span><span class=p>.</span><span class=nx>Params</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>fmt</span><span class=p>.</span><span class=nx>Fprint</span><span class=p>(</span><span class=nx>w</span><span class=p>,</span> <span class=s>&quot;Welcome!\n&quot;</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nx>Hello</span><span class=p>(</span><span class=nx>w</span> <span class=nx>http</span><span class=p>.</span><span class=nx>ResponseWriter</span><span class=p>,</span> <span class=nx>r</span> <span class=o>*</span><span class=nx>http</span><span class=p>.</span><span class=nx>Request</span><span class=p>,</span> <span class=nx>ps</span> <span class=nx>httprouter</span><span class=p>.</span><span class=nx>Params</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>fmt</span><span class=p>.</span><span class=nx>Fprintf</span><span class=p>(</span><span class=nx>w</span><span class=p>,</span> <span class=s>&quot;hello, %s!\n&quot;</span><span class=p>,</span> <span class=nx>ps</span><span class=p>.</span><span class=nx>ByName</span><span class=p>(</span><span class=s>&quot;name&quot;</span><span class=p>))</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nx>getuser</span><span class=p>(</span><span class=nx>w</span> <span class=nx>http</span><span class=p>.</span><span class=nx>ResponseWriter</span><span class=p>,</span> <span class=nx>r</span> <span class=o>*</span><span class=nx>http</span><span class=p>.</span><span class=nx>Request</span><span class=p>,</span> <span class=nx>ps</span> <span class=nx>httprouter</span><span class=p>.</span><span class=nx>Params</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>uid</span> <span class=o>:=</span> <span class=nx>ps</span><span class=p>.</span><span class=nx>ByName</span><span class=p>(</span><span class=s>&quot;uid&quot;</span><span class=p>)</span>
    <span class=nx>fmt</span><span class=p>.</span><span class=nx>Fprintf</span><span class=p>(</span><span class=nx>w</span><span class=p>,</span> <span class=s>&quot;you are get user %s&quot;</span><span class=p>,</span> <span class=nx>uid</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nx>modifyuser</span><span class=p>(</span><span class=nx>w</span> <span class=nx>http</span><span class=p>.</span><span class=nx>ResponseWriter</span><span class=p>,</span> <span class=nx>r</span> <span class=o>*</span><span class=nx>http</span><span class=p>.</span><span class=nx>Request</span><span class=p>,</span> <span class=nx>ps</span> <span class=nx>httprouter</span><span class=p>.</span><span class=nx>Params</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>uid</span> <span class=o>:=</span> <span class=nx>ps</span><span class=p>.</span><span class=nx>ByName</span><span class=p>(</span><span class=s>&quot;uid&quot;</span><span class=p>)</span>
    <span class=nx>fmt</span><span class=p>.</span><span class=nx>Fprintf</span><span class=p>(</span><span class=nx>w</span><span class=p>,</span> <span class=s>&quot;you are modify user %s&quot;</span><span class=p>,</span> <span class=nx>uid</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nx>deleteuser</span><span class=p>(</span><span class=nx>w</span> <span class=nx>http</span><span class=p>.</span><span class=nx>ResponseWriter</span><span class=p>,</span> <span class=nx>r</span> <span class=o>*</span><span class=nx>http</span><span class=p>.</span><span class=nx>Request</span><span class=p>,</span> <span class=nx>ps</span> <span class=nx>httprouter</span><span class=p>.</span><span class=nx>Params</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>uid</span> <span class=o>:=</span> <span class=nx>ps</span><span class=p>.</span><span class=nx>ByName</span><span class=p>(</span><span class=s>&quot;uid&quot;</span><span class=p>)</span>
    <span class=nx>fmt</span><span class=p>.</span><span class=nx>Fprintf</span><span class=p>(</span><span class=nx>w</span><span class=p>,</span> <span class=s>&quot;you are delete user %s&quot;</span><span class=p>,</span> <span class=nx>uid</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nx>adduser</span><span class=p>(</span><span class=nx>w</span> <span class=nx>http</span><span class=p>.</span><span class=nx>ResponseWriter</span><span class=p>,</span> <span class=nx>r</span> <span class=o>*</span><span class=nx>http</span><span class=p>.</span><span class=nx>Request</span><span class=p>,</span> <span class=nx>ps</span> <span class=nx>httprouter</span><span class=p>.</span><span class=nx>Params</span><span class=p>)</span> <span class=p>{</span>
    <span class=c1>// uid := r.FormValue(&quot;uid&quot;)</span>
    <span class=nx>uid</span> <span class=o>:=</span> <span class=nx>ps</span><span class=p>.</span><span class=nx>ByName</span><span class=p>(</span><span class=s>&quot;uid&quot;</span><span class=p>)</span>
    <span class=nx>fmt</span><span class=p>.</span><span class=nx>Fprintf</span><span class=p>(</span><span class=nx>w</span><span class=p>,</span> <span class=s>&quot;you are add user %s&quot;</span><span class=p>,</span> <span class=nx>uid</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nx>main</span><span class=p>()</span> <span class=p>{</span>
    <span class=nx>router</span> <span class=o>:=</span> <span class=nx>httprouter</span><span class=p>.</span><span class=nx>New</span><span class=p>()</span>
    <span class=nx>router</span><span class=p>.</span><span class=nx>GET</span><span class=p>(</span><span class=s>&quot;/&quot;</span><span class=p>,</span> <span class=nx>Index</span><span class=p>)</span>
    <span class=nx>router</span><span class=p>.</span><span class=nx>GET</span><span class=p>(</span><span class=s>&quot;/hello/:name&quot;</span><span class=p>,</span> <span class=nx>Hello</span><span class=p>)</span>

    <span class=nx>router</span><span class=p>.</span><span class=nx>GET</span><span class=p>(</span><span class=s>&quot;/user/:uid&quot;</span><span class=p>,</span> <span class=nx>getuser</span><span class=p>)</span>
    <span class=nx>router</span><span class=p>.</span><span class=nx>POST</span><span class=p>(</span><span class=s>&quot;/adduser/:uid&quot;</span><span class=p>,</span> <span class=nx>adduser</span><span class=p>)</span>
    <span class=nx>router</span><span class=p>.</span><span class=nx>DELETE</span><span class=p>(</span><span class=s>&quot;/deluser/:uid&quot;</span><span class=p>,</span> <span class=nx>deleteuser</span><span class=p>)</span>
    <span class=nx>router</span><span class=p>.</span><span class=nx>PUT</span><span class=p>(</span><span class=s>&quot;/moduser/:uid&quot;</span><span class=p>,</span> <span class=nx>modifyuser</span><span class=p>)</span>

    <span class=nx>log</span><span class=p>.</span><span class=nx>Fatal</span><span class=p>(</span><span class=nx>http</span><span class=p>.</span><span class=nx>ListenAndServe</span><span class=p>(</span><span class=s>&quot;:8080&quot;</span><span class=p>,</span> <span class=nx>router</span><span class=p>))</span>
<span class=p>}</span>
</code></pre></div> <p>é€šè¿‡ä¸Šé¢çš„ä»£ç å¯çŸ¥ï¼ŒRESTå°±æ˜¯æ ¹æ®ä¸åŒçš„methodè®¿é—®åŒä¸€ä¸ªèµ„æºçš„æ—¶å€™å®ç°ä¸åŒçš„é€»è¾‘å¤„ç†ã€‚</p> <hr> <div class=md-source-date> <small> Last update: May 16, 2020 </small> </div> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/vendor.22b62ea4.min.js></script> <script src=../../assets/javascripts/bundle.5f27aba8.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script> <script>
        app = initialize({
          base: "../..",
          features: ["instant", "tabs"],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.f6ebf1dc.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>
<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.1.2, mkdocs-material-5.1.7"><title>RESTful 架构 - Notes</title><link rel=stylesheet href=../../assets/stylesheets/main.4c7052ca.min.css><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style></head> <body dir=ltr> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#restful class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=../.. title=Notes class="md-header-nav__button md-logo" aria-label=Notes> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> Notes </span> <span class="md-header-nav__topic md-ellipsis"> RESTful 架构 </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class="md-tabs__link md-tabs__link--active"> Home </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=Notes class="md-nav__button md-logo" aria-label=Notes> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. title=Home class=md-nav__link> Home </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#uri class=md-nav__link> 资源与 URI </a> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> 统一资源接口 </a> <nav class=md-nav aria-label=统一资源接口> <ul class=md-nav__list> <li class=md-nav__item> <a href=#get class=md-nav__link> GET </a> </li> <li class=md-nav__item> <a href=#post class=md-nav__link> POST </a> </li> <li class=md-nav__item> <a href=#put class=md-nav__link> PUT </a> </li> <li class=md-nav__item> <a href=#delete class=md-nav__link> DELETE </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 资源的表述 </a> <nav class=md-nav aria-label=资源的表述> <ul class=md-nav__list> <li class=md-nav__item> <a href=#uri_1 class=md-nav__link> 使用 URI 后缀来区分表述格式 </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 处理不支持的表述格式 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 资源的链接 </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 状态的转移 </a> <nav class=md-nav aria-label=状态的转移> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 应用状态与资源状态 </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> 应用状态的转移 </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=restful>RESTful 架构<a class=headerlink href=#restful title="Permanent link">&para;</a></h1> <p>REST 全称是 Representational State Transfer，中文意思是表述（编者注：通常译为表征）性状态转移。</p> <p>REST 指的是一组架构约束条件和原则。如果一个架构符合 REST 的约束条件和原则，我们就称它为 RESTful 架构。</p> <p>REST 本身并没有创造新的技术、组件或服务，而隐藏在 RESTful 背后的理念就是使用 Web 的现有特征和能力， 更好地使用现有 Web 标准中的一些准则和约束。</p> <p>虽然 REST 本身受 Web 技术的影响很深， 但是理论上 REST 架构风格并不是绑定在 HTTP 上，只不过目前 HTTP 是唯一与 REST 相关的实例。 </p> <p>RESTful 架构与传统的 RPC、SOAP 等方式在理念上有很大的不同。</p> <hr> <p>下面结合 REST 原则，围绕资源展开讨论，从资源的定义、获取、表述、关联、状态变迁等角度，列举一些关键概念并加以解释。</p> <ul> <li>资源与 URI</li> <li>统一资源接口</li> <li>资源的表述</li> <li>资源的链接</li> <li>状态的转移</li> </ul> <h2 id=uri>资源与 URI<a class=headerlink href=#uri title="Permanent link">&para;</a></h2> <p>任何事物，只要有被引用到的必要，它就是一个资源。要让一个资源可以被识别，需要有个唯一标识，在 Web 中这个唯一标识就是 URI (Uniform Resource Identifier)。</p> <ul> <li>使用_或 - 来让 URI 可读性更好</li> <li>使用 / 来表示资源的层级关系</li> <li>使用？用来过滤资源</li> <li>, 或；可以用来表示同级资源的关系</li> </ul> <h2 id=_1>统一资源接口<a class=headerlink href=#_1 title="Permanent link">&para;</a></h2> <p>RESTful 架构应该遵循统一接口原则，统一接口包含了一组受限的预定义的操作，不论什么样的资源，都是通过使用相同的接口进行资源的访问。统一资源接口要求使用标准的 HTTP 方法对资源进行操作。</p> <p>如果按照 HTTP 方法的语义来暴露资源，那么接口将会拥有安全性和幂等性的特性。</p> <ul> <li> <p>GET 和 HEAD 请求都是安全的， 无论请求多少次，都不会改变服务器状态。</p> </li> <li> <p>而 GET、HEAD、PUT 和 DELETE 请求都是幂等的，无论对资源操作多少次， 结果总是一样的，后面的请求并不会产生比第一次更多的影响。</p> </li> <li>POST 和 PUT 在创建资源的区别在于，所创建的资源的名称 (URI) 是否由客户端决定。 </li> <li>一些比较古老的基于浏览器的客户端，只能支持 GET 和 POST 两种方法。</li> <li>统一接口不意味着不能扩展带特殊语义的方法，不过服务端需要考虑客户端是否能够支持的问题。</li> <li></li> </ul> <h3 id=get>GET<a class=headerlink href=#get title="Permanent link">&para;</a></h3> <ul> <li>安全且幂等</li> <li>获取表示</li> <li> <p>变更时获取表示（缓存）</p> </li> <li> <p>200（OK） - 表示已在响应中发出</p> </li> <li> <p>204（无内容） - 资源有空表示</p> </li> <li>301（Moved Permanently） - 资源的 URI 已被更新</li> <li>303（See Other） - 其他（如，负载均衡）</li> <li>304（not modified）- 资源未更改（缓存）</li> <li>400 （bad request）- 指代坏请求（如，参数错误）</li> <li>404 （not found）- 资源不存在</li> <li>406 （not acceptable）- 服务端不支持所需表示</li> <li>500 （internal server error）- 通用错误响应</li> <li>503 （Service Unavailable）- 服务端当前无法处理请求</li> </ul> <h3 id=post>POST<a class=headerlink href=#post title="Permanent link">&para;</a></h3> <ul> <li>不安全且不幂等</li> <li>使用服务端管理的（自动产生）的实例号创建资源</li> <li>创建子资源</li> <li>部分更新资源</li> <li> <p>如果没有被修改，则不过更新资源（乐观锁）</p> </li> <li> <p>200（OK）- 如果现有资源已被更改</p> </li> <li> <p>201（created）- 如果新资源被创建</p> </li> <li>202（accepted）- 已接受处理请求但尚未完成（异步处理）</li> <li>301（Moved Permanently）- 资源的 URI 被更新</li> <li>303（See Other）- 其他（如，负载均衡）</li> <li>400（bad request）- 指代坏请求</li> <li>404 （not found）- 资源不存在</li> <li>406 （not acceptable）- 服务端不支持所需表示</li> <li>409 （conflict）- 通用冲突</li> <li>412 （Precondition Failed）- 前置条件失败（如执行条件更新时的冲突）</li> <li>415 （unsupported media type）- 接受到的表示不受支持</li> <li>500 （internal server error）- 通用错误响应</li> <li>503 （Service Unavailable）- 服务当前无法处理请求</li> </ul> <h3 id=put>PUT<a class=headerlink href=#put title="Permanent link">&para;</a></h3> <ul> <li>不安全但幂等</li> <li>用客户端管理的实例号创建一个资源</li> <li>通过替换的方式更新资源</li> <li> <p>如果未被修改，则更新资源（乐观锁）</p> </li> <li> <p>200 （OK）- 如果已存在资源被更改</p> </li> <li> <p>201 （created）- 如果新资源被创建</p> </li> <li>301（Moved Permanently）- 资源的 URI 已更改</li> <li>303 （See Other）- 其他（如，负载均衡）</li> <li>400 （bad request）- 指代坏请求</li> <li>404 （not found）- 资源不存在</li> <li>406 （not acceptable）- 服务端不支持所需表示</li> <li>409 （conflict）- 通用冲突</li> <li>412 （Precondition Failed）- 前置条件失败（如执行条件更新时的冲突）</li> <li>415 （unsupported media type）- 接受到的表示不受支持</li> <li>500 （internal server error）- 通用错误响应</li> <li>503 （Service Unavailable）- 服务当前无法处理请求</li> </ul> <h3 id=delete>DELETE<a class=headerlink href=#delete title="Permanent link">&para;</a></h3> <ul> <li>不安全但幂等</li> <li> <p>删除资源</p> </li> <li> <p>200 （OK）- 资源已被删除</p> </li> <li> <p>301 （Moved Permanently）- 资源的 URI 已更改</p> </li> <li>303 （See Other）- 其他，如负载均衡</li> <li>400 （bad request）- 指代坏请求</li> <li>404 （not found）- 资源不存在</li> <li>409 （conflict）- 通用冲突</li> <li>500 （internal server error）- 通用错误响应</li> <li>503 （Service Unavailable）- 服务端当前无法处理请求</li> </ul> <h2 id=_2>资源的表述<a class=headerlink href=#_2 title="Permanent link">&para;</a></h2> <p>通过 HTTP 内容协商，客户端可以通过 Accept 头请求一种特定格式的表述，服务端则通过 Content-Type 告诉客户端资源的表述形式。</p> <h3 id=uri_1>使用 URI 后缀来区分表述格式<a class=headerlink href=#uri_1 title="Permanent link">&para;</a></h3> <p>像 rails 框架，就支持使用 /users.xml 或 /users.json 来区分不同的格式。 这样的方式对于客户端来说，无疑是更为直观，但混淆了资源的名称和资源的表述形式。</p> <h3 id=_3>处理不支持的表述格式<a class=headerlink href=#_3 title="Permanent link">&para;</a></h3> <p>当服务器不支持所请求的表述格式，它应该返回一个 HTTP 406 响应，表示拒绝处理该请求。</p> <h2 id=_4>资源的链接<a class=headerlink href=#_4 title="Permanent link">&para;</a></h2> <p>术语：超媒体即应用状态引擎（hypermedia as the engine of application state）</p> <p>当你浏览 Web 网页时，从一个连接跳到一个页面，再从另一个连接跳到另外一个页面，就是利用了超媒体的概念：把一个个把资源链接起来。要达到这个目的，就要求在表述格式里边加入链接来引导客户端。</p> <p>应该多花一些时间来给资源的表述提供链接，而不是专注于 "资源的 CRUD"。</p> <h2 id=_5>状态的转移<a class=headerlink href=#_5 title="Permanent link">&para;</a></h2> <p>EST 原则中的无状态通信原则：不是说客户端应用不能有状态，而是指服务端不应该保存客户端状态。</p> <h3 id=_6>应用状态与资源状态<a class=headerlink href=#_6 title="Permanent link">&para;</a></h3> <ul> <li> <p>状态应该区分应用状态和资源状态，客户端负责维护应用状态，而服务端维护资源状态。</p> </li> <li> <p>客户端与服务端的交互必须是无状态的，并在每一次请求中包含处理该请求所需的一切信息。</p> </li> <li> <p>服务端不需要在请求间保留应用状态，只有在接受到实际请求的时候，服务端才会关注应用状态。</p> </li> <li> <p>无状态通信原则，使得服务端和中介能够理解独立的请求和响应。</p> </li> <li> <p>在多次请求中，同一客户端也不再需要依赖于同一服务器，方便实现高可扩展和高可用性的服务端。</p> </li> <li> <p>但有时候我们会做出违反无状态通信原则的设计，例如利用 Cookie 跟踪某个服务端会话状态，常见的像 J2EE 里边的 JSESSIONID。</p> </li> </ul> <h3 id=_7>应用状态的转移<a class=headerlink href=#_7 title="Permanent link">&para;</a></h3> <p>类似 "下一页" 之类的链接起推进状态的作用 —— 指引你如何从当前状态进入下一个可能的状态。</p> <ul> <li> <p>"会话" 状态不是作为资源状态保存在服务端的，而是被客户端作为应用状态进行跟踪的。</p> </li> <li> <p>客户端应用状态在服务端提供的超媒体的指引下发生变迁。</p> </li> <li> <p>服务端通过超媒体告诉客户端当前状态有哪些后续状态可以进入。</p> </li> </ul> <hr> <div class=md-source-date> <small> Last update: May 16, 2020 </small> </div> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/vendor.22b62ea4.min.js></script> <script src=../../assets/javascripts/bundle.5f27aba8.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script> <script>
        app = initialize({
          base: "../..",
          features: ["instant", "tabs"],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.f6ebf1dc.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>